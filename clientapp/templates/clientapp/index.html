{% extends 'clientapp/base.html' %}

{% block content %}
<div class="container">

    <form method="POST" action="{% url 'index' %}">

        <div id="search_box" class="collapse">
            <div class="row justify-content-between">
                <div class="row col-sm-6 d-flex container mt-2" id="client-info">
                    <label for="full_name" class="col-sm-4 col-form-label">
                        Full Name
                        <span style="color: red">*</span>
                    </label>
                    <div class="col-sm-8">
                        <input type="input" id="full_name" class="form-control" name="full_name" value="{{ full_name }}">
                    </div>
                </div>

                <div class="row col-sm-6 d-flex container mt-2" id="client-info">
                    <label for="contact_name" class="col-sm-4 col-form-label">Contact Name</label>
                    <div class="col-sm-8">
                        <input type="input" id="contact_name" class="form-control" name="contact_name" value="{{ contact_name }}">
                    </div>
                </div>
            </div>

            <div class="row justify-content-between">
                <div class="row col-sm-6 d-flex container mt-2" id="client-info">
                    <label for="email_address" class="col-sm-4 col-form-label">
                        Email Address
                        <span style="color: red">*</span>
                    </label>
                    <div class="col-sm-8">
                        <input type="email" id="email_address" class="form-control" name="email_address" aria-describedby="emailHelp" value="{{ email_address }}">
                    </div>
                </div>

                <div class="row col-sm-6 d-flex container mt-2" id="client-info">
                    <label for="phone_number" class="col-sm-4 col-form-label">
                        Phone Number
                        <span style="color: red">*</span>
                    </label>
                    <div class="col-sm-8">
                        <input type="input" id="phone_number" class="form-control" name="phone_number" value="{{ phone_number }}">
                    </div>
                </div>
            </div>

            <div class="row d-flex align-items-end justify-content-end pr-3 pb-2 mt-3">
                <button class="btn btn-info" type="submit">Search</button>
            </div>
        </div>
    </form>


    <div class="row d-flex align-items-baseline justify-content-end pr-3 pb-2 mt-1">
        <div class="row d-flex align-items-end justify-content-end pr-3 pb-2 mt-3">
            <a data-toggle="collapse" href="#search_box" aria-expanded="false" aria-controls="search_box">
                Search Options...
            </a>
        </div>

        <div class="ml-3">
            <label for="sort-by">Sort By:</label>
            <select class="ml-2" id="sort-by">
                <option value="{% url 'index' %}?sortby=full_name" id="full_name">
                    Name
                </option>

                <option value="{% url 'index' %}?sortby=email_address" id="email_address">
                    Email Address
                </option>

                <option value="{% url 'index' %}?sortby=phone_number" id="phone_number">
                    Phone Number
                </option>
            </select>
        </div>
    </div>

    <table class="table">
        <thead class="thead-light">
            <tr>
                <th scope="col">Name</th>
                <th scope="col">Address</th>
                <th scope="col">Contact Name</th>
                <th scope="col">Email</th>
                <th scope="col">Phone Number</th>
            </tr>
        </thead>

        <tbody>
            {% for client in clients %}
            <tr>
                <th scope="row">
                    <a href="{% url 'client_update' client_id=client.id %}">
                        {{ client.full_name }}
                    </a>
                </th>
                <th>{{ client.address }}</th>
                <th>{{ client.contact_name }}</th>
                <th>{{ client.email_address }}</th>
                <th>{{ client.phone_number }}</th>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="row pt-5 pl-4">
        <a href="{% url 'client_new' %}">
            <button type="submit" class="btn btn-info">Add New</button>
        </a>
    </div>
</div>
{% endblock %}


{% block javascript %}
<script type="text/javascript">
    $(document).ready(function() {
        let params = (new URL(document.location)).searchParams;
        let sortby = params.get("sortby");

        $("#"+sortby).attr('selected', 'selected');

        $("#sort-by").change(function() {
            window.location = this.value
        });
    });
</script>
{% endblock %}